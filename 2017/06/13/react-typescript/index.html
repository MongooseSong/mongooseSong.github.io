<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 使用TypeScript集成React | The Song from A Mongoose</title><meta name="description" content="使用TypeScript集成React - mongoose"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.ico"><link rel="stylesheet" href="/scss/casual.css"><link rel="stylesheet" href="/css/icon.css"><link rel="search" type="application/opensearchdescription+xml" href="https://mongoosesong.github.io/atom.xml" title="The Song from A Mongoose"></head><body><div class="header"><header class="site-header"><div class="site-nav"><span class="button-toggle"></span><div class="container"><div class="nav-item"><a href="/" target="_self" data-text="home">主页</a></div><div class="nav-item"><a href="/archives" target="_self" data-text="archive">归档</a></div><div class="nav-item"><a href="/about" target="_self" data-text="about">关于</a></div><div class="nav-item"><a href="/atom.xml" target="_self" data-text="rss">订阅</a></div></div><form id="search-form" class="nav-item"><input type="text" id="local-search-input" name="q" results="0" placeholder="搜索" autocomplete="off" autocorrect="off" class="search form-control"><span onclick="resetSearch()" class="fa fa-times"> </span></form><div id="local-search-result"></div><p class="no-result">No results found</p></div></header></div><div class="main"><div class="container"><div class="content"><div class="post"><article class="post-block"><h1 class="post-title">使用TypeScript集成React</h1><span class="post-date">2017年6月13日</span><span class="post-review">阅读次数 : <span data-hk-page="current">-</span></span><div class="post-content"><h3 id="一、Webpack项目添加TypeScript支持"><a href="#一、Webpack项目添加TypeScript支持" class="headerlink" title="一、Webpack项目添加TypeScript支持"></a>一、Webpack项目添加TypeScript支持</h3><ol>
<li><p>安装npm包 </p>
<pre><code>tnpm i --save  @types/react @types/react-dom
tnpm i --save-dev ts-loader
</code></pre></li>
</ol>
<ol>
<li><p>webpack配置文件，添加对后缀名的识别</p>
<pre><code>resolve: {
    extensions: [&apos;&apos;, &apos;.webpack.js&apos;, &apos;.web.js&apos;, &apos;.ts&apos;, &apos;.tsx&apos;, &apos;.js&apos;]
  }
</code></pre></li>
</ol>
<ol>
<li><p>webpack添加loader，添加对ts和tsx文件的解析</p>
<pre><code>loaders: [{
        test: /\.tsx?$/,
        loader: &apos;ts-loader&apos;
  }],                  
</code></pre></li>
</ol>
<ol>
<li><p>项目根路径下添加tsconfig.json文件，配置项参见<a href="http://www.typescriptlang.org/docs/handbook/tsconfig-json.html" target="_blank" rel="external">官方文档</a></p>
<p> 这里直接不劳而获的贴出网上流行的内容：</p>
<pre><code>{
  &quot;compilerOptions&quot;: {
    &quot;outDir&quot;: &quot;./build/&quot;,
    &quot;sourceMap&quot;: true,
    &quot;noImplicitAny&quot;: true,
    &quot;module&quot;: &quot;commonjs&quot;,
    &quot;target&quot;: &quot;es5&quot;,
    &quot;jsx&quot;: &quot;react&quot;
  },
  &quot;exclude&quot;: [
    &quot;node_modules&quot;
  ]
} 
</code></pre></li>
</ol>
<ol>
<li>在这之后，可以在项目中直接写 ts 或者 tsx 文件了，会和其他的jsx文件一同以es5的形式被编译到pages文件里面。    </li>
</ol>
<h3 id="二、VSCODE集成ESLint和TSLint"><a href="#二、VSCODE集成ESLint和TSLint" class="headerlink" title="二、VSCODE集成ESLint和TSLint"></a>二、VSCODE集成ESLint和TSLint</h3><p>其实之前我IDE一直用的Webstorm，直到某一天项目再也打不开了……<br>VSCode一个好处是比Webstorm轻，没有很多不需要的功能，不像Webstorm需求的内存那么大，另外一点是很多必备的功能（如原生支持JSX、ES6等）都已经集成了，而且插件库来说还是比较全的。  </p>
<ul>
<li>支持<code>ESLint</code></li>
</ul>
<p>只需要安装<code>ESLint</code>这个插件即可。工程下已经有相应的.eslintrc文件和devDependencies了。</p>
<ul>
<li>支持<code>TSLint</code></li>
</ul>
<p><code>TSLint</code>是TypeScript的Lint文件。</p>
<ol>
<li>先安装： <code>tnpm install --save-dev tslint</code>    </li>
<li>再安装插件：<code>TSLint</code>   </li>
<li>最后在项目下新建一个tslint.json文件，这是规则文件，可以参考<a href="https://github.com/palantir/tslint/blob/master/tslint.json" target="_blank" rel="external">https://github.com/palantir/tslint/blob/master/tslint.json</a> 这里的例子。  </li>
<li>此时编辑器已经对你的ts或者tsx文件开始进行检查了。  </li>
</ol>
<h3 id="三、使用TSX一些额外注意的地方："><a href="#三、使用TSX一些额外注意的地方：" class="headerlink" title="三、使用TSX一些额外注意的地方："></a>三、使用TSX一些额外注意的地方：</h3><h4 id="1-类型断言"><a href="#1-类型断言" class="headerlink" title="1. 类型断言"></a>1. 类型断言</h4><p>使用纯TypeScript，可以对类型进行断言:</p>
<pre><code>let foo: any = &apos;just a string&apos;;
let bar: number = (&lt;string&gt;foo).length;
</code></pre><p>此时会告诉编译器，请把any类型的foo当作string类型看待(不论是不是string)，但是在tsx文件中，只能使用<code>as</code>进行断言：</p>
<pre><code>let foo: any = &apos;just a string&apos;;
let bar: number = (foo as string).length;
</code></pre><p>这个问题主要还是因为对尖括号的识别引起的。所有遇到类型断言的地方，都应该使用<code>as</code>替代左右尖括号。</p>
<p>PS: 泛型并不需要，因为语法解析的时候可以正确的识别尖括号里面的是泛型还是DOM元素。</p>
<h4 id="2-React-Class写法"><a href="#2-React-Class写法" class="headerlink" title="2. React Class写法"></a>2. React Class写法</h4><p>所有React组件类都需要继承这一个类：</p>
<pre><code>React.Component&lt;IAppProps, IAppState&gt;
</code></pre><p>其中必须使用泛型<code>IAppProps</code>和<code>IAppState</code>,分别指定了<code>props</code>的类型和<code>state</code>的类型，应该可以使用interface的方式指定约束，这样编辑器在访问<code>props</code>,<code>state</code>属性以及<code>setState</code>,<code>nextProps</code>等的时候都能进行校验(你也可以指定any放弃校验，或者根本不需要使用时)，这样就把propType的校验提前到编译阶段了。</p>
<p>render方法是这么定义的：</p>
<pre><code>public render(): JSX.Element { 

     /** Render Code **/

}
</code></pre><p>其中返回类型是可以不用写的，因为父类已经定义好了返回类型。</p>
<p>参考Antd的写法，一般来说这些类型定义都放在同一个文件中。        </p>
<h4 id="3-结合Redux或者其他第三方库"><a href="#3-结合Redux或者其他第三方库" class="headerlink" title="3. 结合Redux或者其他第三方库"></a>3. 结合Redux或者其他第三方库</h4><p>现在比较流行的库都自带了<code>xxx.d.ts</code>文件来定义一些元数据，如果没有，可以在npm仓库搜索<code>@types/xxx</code>下载相应的元数据文件(比如一开始需要安装的<code>@types/react</code>等等)。</p>
<p>redux自带了index.d.ts文件，提供了常见一些redux方法的实现，比如<code>applyMiddleware</code>等等，至于写action和reducer，则完全遵从TypeScript的规范即可。</p>
<h3 id="四、其他补充"><a href="#四、其他补充" class="headerlink" title="四、其他补充"></a>四、其他补充</h3><p>总体来说感觉TypeScript能规范不少代码规则，提高开发和Review的效率，更多的东西，正在不断的探索和研究中……</p>
</div></article></div><div class="post-paginator"><div class="post-links"><div class="post-prev"><a href="/2017/08/15/js-metaprog/" class="prev">上一篇<span>JavaScript元编程</span></a></div><div class="post-next"><a href="/2017/06/13/uglifyjs/" class="next">下一篇<span>丑化你的JS代码</span></a></div></div></div><div id="uyan_frame"></div></div><div class="sidebar"><div class="social-links"><ul><li class="social-link"><a href="http://github.com/littlewin-wang" target="_blank" class="link-github"><i class="icon icon-github"></i></a></li><li class="social-link"><a href="http://twitter.com/littlewin_wang" target="_blank" class="link-twitter"><i class="icon icon-twitter"></i></a></li><li class="social-link"><a href="http://weibo.com/fredinweibo" target="_blank" class="link-weibo"><i class="icon icon-weibo"></i></a></li><li class="social-link"><a href="mailto:littlewin.wang@gmail.com" target="_self" class="link-mail"><i class="icon icon-mail"></i></a></li></ul></div><div class="recent-posts widget"><h3 class="widget-title"> 近期文章</h3><div class="widget-content"><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2017/08/15/js-metaprog/">JavaScript元编程</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/13/react-typescript/">使用TypeScript集成React</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/13/uglifyjs/">丑化你的JS代码</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/06/13/react-lifecycle/">React生命周期</a></li></ul></div></div><div class="recent-comment widget"><h3 class="widget-title"> 近期评论</h3><div class="widget-content"><div id="uyan_newcmt_unit"></div></div></div><div class="tag-lists widget"><h3 class="widget-title"> 标签</h3><div class="widget-content"><a class="tag-link" href="/tags/React/">React</a> <a class="tag-link" href="/tags/前端/">前端</a> <a class="tag-link" href="/tags/开发工具/">开发工具</a></div></div><div class="archive-lists widget"><h3 class="widget-title"> 归档</h3><div class="widget-content"><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">八月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">3</span></li></ul></div></div></div></div></div><footer><div class="copyright"><div class="container"><div class="col-6"><div class="site-info">© 2016 - 2017 <span class="icon icon-heart"></span> <a href="https://mongoosesong.github.io">mongoose</a><span class="sep">/</span><a href="https://hexo.io/" target="_blank">Powered by Hexo</a><span class="sep">/</span><a href="https://github.com/littlewin-wang/hexo-theme-casual" target="_blank">Theme by casual</a></div></div><div class="col-6"><div class="site-contact"><div class="social-links"><ul><li class="social-link"><a href="http://github.com/littlewin-wang" target="_blank" class="link-github"><i class="icon icon-github"></i></a></li><li class="social-link"><a href="http://twitter.com/littlewin_wang" target="_blank" class="link-twitter"><i class="icon icon-twitter"></i></a></li><li class="social-link"><a href="http://weibo.com/fredinweibo" target="_blank" class="link-weibo"><i class="icon icon-weibo"></i></a></li><li class="social-link"><a href="mailto:littlewin.wang@gmail.com" target="_self" class="link-mail"><i class="icon icon-mail"></i></a></li></ul></div></div></div></div></div></footer><a class="scroll-up"><span class="icon icon-up"></span></a><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script><script src="/js/posfixed.js"></script><script src="/js/utils.js"></script><script src="/js/search.js"></script><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2128137"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-92791318-1",'auto');ga('send','pageview');</script><script src="https://cdn1.lncld.net/static/js/av-mini-0.6.10.js"></script><script src="http://jerry-cdn.b0.upaiyun.com/hit-kounter/hit-kounter-lc-0.2.0.js"></script></body></html>